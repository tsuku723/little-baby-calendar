# 画面一覧・画面遷移定義（最新版／初回セットアップ強化・Today画面・複数プロフィール対応）

本ドキュメントは、既存の画面構成（S-01〜S-05）に加えて、  
**トップ画面（Today Screen）の新設**  
**複数プロフィール対応**  
を反映した最新版である。

---

# 1. 画面一覧（改訂版）

| ID   | 画面名                               | 役割・目的 |
|------|--------------------------------------|-------------|
| S-01 | 初回セットアップ画面（強化版）       | 子どものプロフィール（名前・出生日・予定日・設定）を登録する |
| S-01B| プロフィール管理画面（複数ユーザー） | 子どもの追加・編集・削除、アクティブユーザー切り替え |
| S-02 | **Today 画面（新規）**               | 今日の実月齢・修正月齢・日齢・最新の記録を表示するトップ画面 |
| S-03 | カレンダー画面                        | 実月齢／修正月齢を月表示で一覧し、任意の日付にアクセスする |
| S-04 | 日付詳細シート（モーダル）            | 特定の日付の詳細（実／修・日齢・記録）を確認・操作する |
| S-05 | 記録一覧画面                           | 登録した記録（旧：できた／頑張った）を横断的に振り返る |
| S-06 | 設定画面                               | 表示設定・プロフィール編集などを行う |

---

# 2. 各画面の詳細仕様

---

## ■ S-01 初回セットアップ画面（強化版）

### 目的
アプリ初回起動時に、  
**子どもの基本情報＋年齢計算に必要な情報** を正確に登録する。

### 表示項目
- タイトル：はじめに
- 入力フォーム
  - 子どもの名前（必須）
  - 出生日（必須・DatePicker）
  - 出産予定日（任意・DatePicker）
  - 修正月齢表示上限（24m / 36m / 制限なし）
  - 年齢表示形式（md / ymd）
  - 生後日数表示（ON/OFF）

### UX強化点
- 入力補助
  - DatePickerで直感的に選択
  - 最近3年の範囲を初期位置にする
- バリデーション
  - 出生日は未来不可
  - 予定日が出生日より極端に未来の場合は警告

### 保存
- 子ども1名分のプロフィールとして保存
- 保存後は **S-02 Today画面** へ遷移（旧：カレンダーではなく、新トップ画面）

---

## ■ S-01B プロフィール管理画面（新規／複数プロフィール対応）

### 目的
兄弟・双子など、複数の子どもを安全に管理・切り替える。

### 表示項目
- 登録済みプロフィール一覧
  - 名前
  - 出生日
  - 予定日（任意）
  - アクティブ状態（チェックマーク）
- ボタン
  - ＋ 子どもを追加する
  - プロフィール編集（名前／日付／設定）
  - 削除（確認ダイアログあり）

### 挙動
- 一覧のタップで「現在選択中の子」を切り替える
- 削除時、該当ユーザーの記録データ（Achievements）も同時に削除
- 子どもは 3〜5名程度を想定（上限は実装方針による）

### 遷移
- S-02（Today）→ メニュー → S-01B
- S-01B → 戻る → S-02

---

## ■ S-02 Today 画面（新規）※アプリのトップ画面

### 目的
アプリを開いた瞬間に、  
**今日の“安心感”を最も効率よく提供する。**

### 表示項目
- 子どもの名前（アクティブプロフィール）
- 今日の日付（YYYY/MM/DD）
- 実月齢
- 修正月齢（同値の場合は非表示）
- 生後日数（設定 ON の場合のみ）
- 今日の記録
  - 最新1件を表示
  - なければ「今日はまだ記録がありません」
- ボタン
  - 「記録する」→ 今日の日付で新規記録
  - 「カレンダーを見る」
  - 「記録一覧」
  - プロフィール切替（アイコン or ドロップダウン）

### 挙動
- アプリ起動時は常に S-02
- プロフィールを切り替えると、表示内容すべてを再計算

---

## ■ S-03 カレンダー画面（従来 S-02）

（※従来仕様＋複数プロフィール管理に対応）

### 目的
月単位で実月齢／修正月齢を俯瞰し、日付詳細（S-04）へアクセスする。

### 主な仕様
- 前月／翌月移動、今日へ戻る
- 各セルに実／修を表示（表記ルール従来どおり）
- 記録がある日は「●」を表示
- プロフィール切替に連動して再描画

### 遷移
- S-02 → 「カレンダーを見る」→ S-03
- S-03 → 日付セルタップ → S-04

---

## ■ S-04 日付詳細シート（モーダル）

### 目的
対象日の実／修／日齢／記録の追加・編集・削除を行う。

### 表示事項
- 日付
- 実月齢
- 修正月齢
- 生後日数（設定ON時）
- 記録一覧（当日のデータのみ）
- 「＋記録する」

### 挙動
- 記録の追加／編集／削除は activeUser に紐づく
- 閉じると S-03 に戻る

---

## ■ S-05 記録一覧画面（旧：できた・頑張った一覧）

### 目的
すべての記録を日付横断で閲覧する。

### 主な表示
- フィルタ：すべて／成長／頑張った
- 日付降順リスト
- タップで S-04（日付詳細）へ移動

### 挙動
- activeUser の記録のみ抽出・表示

---

## ■ S-06 設定画面

### 設定項目
- 出産予定日
- 出生日（基本編集不可にしてもよい）
- 修正月齢表示上限
- 年齢表示形式（md / ymd）
- 生後日数表示 ON/OFF
- プロフィール管理画面への導線（S-01B）

---

# 3. 画面遷移図（改訂版テキスト）

```text
[初回起動]
  S-01 初回セットアップ
      ↓ 保存
  S-02 Today（トップ画面）

[通常起動]
  S-02 Today

S-02 Today
  ・「カレンダーを見る」→ S-03
  ・「記録する」→ S-04（今日の日付）
  ・「記録一覧」→ S-05
  ・プロフィール切替ボタン → S-01B
  ・メニュー → 設定（S-06）

S-01B プロフィール管理
  ・追加／編集／削除
  ・戻る → S-02

S-03 カレンダー
  ・日付タップ → S-04
  ・メニュー → S-05 / S-06
  ・戻る → S-02

S-04 日付詳細シート
  ・追加／編集／削除
  ・閉じる → S-03

S-05 記録一覧
  ・行タップ → S-04
  ・戻る → S-02 または S-03

S-06 設定
  ・戻る → S-02
```

---

# 4. 本改訂で追加されたポイントまとめ

- **Today Screen（新トップ画面）** を追加  
- **プロフィール管理画面 S-01B** を追加  
- すべての画面が **activeUserId** に依存する形に構造変更  
- カレンダーはトップではなく、Today Screen の下に配置  
- 記録は名称を「できた／頑張った」→「記録」へ統一

